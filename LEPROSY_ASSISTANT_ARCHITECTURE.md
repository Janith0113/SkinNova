# Leprosy Care Assistant - Architecture & Flow Diagrams

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (Next.js/React)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Patient Dashboard (/patient/dashboard)                                 â”‚
â”‚  â””â”€ Leprosy Card with "Care Assistant" Button âœ¨                        â”‚
â”‚     â””â”€ Navigates to: /leprosy/assistant                                 â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Leprosy Care Assistant Page (/leprosy/assistant)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚  â”‚  AI Chat ğŸ’¬ â”‚ Symptoms ğŸ“‹  â”‚ Schedule â”‚   Q&A â“ â”‚            â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â”‚  (4 Tab Interface)                                               â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚ â”‚
â”‚  â”‚  â”‚  Chat Component              â”‚                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚ â”‚
â”‚  â”‚  â”‚ Messages Display             â”‚â”€ useState(messages)            â”‚ â”‚
â”‚  â”‚  â”‚ + Input Field + Send Button  â”‚â”€ useState(inputMessage)       â”‚ â”‚
â”‚  â”‚  â”‚ Loading State                â”‚â”€ useState(isLoading)          â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚ â”‚
â”‚  â”‚  â”‚  Symptom Component           â”‚                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚ â”‚
â”‚  â”‚  â”‚ Checkbox List (5 symptoms)   â”‚â”€ useState(symptoms)           â”‚ â”‚
â”‚  â”‚  â”‚ + Notes TextArea             â”‚â”€ useState(symptomNotes)       â”‚ â”‚
â”‚  â”‚  â”‚ + Submit Button              â”‚                               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚ â”‚
â”‚  â”‚  â”‚  Schedule Component          â”‚                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚ â”‚
â”‚  â”‚  â”‚ Weekly Activity List         â”‚â”€ useState(schedule)           â”‚ â”‚
â”‚  â”‚  â”‚ (Mon-Sun with times)         â”‚â”€ DEFAULT_SCHEDULE             â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚ â”‚
â”‚  â”‚  â”‚  Q&A Component               â”‚                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚ â”‚
â”‚  â”‚  â”‚ Search Input                 â”‚â”€ useState(searchFAQ)          â”‚ â”‚
â”‚  â”‚  â”‚ Expandable FAQ List          â”‚â”€ useState(selectedFAQ)        â”‚ â”‚
â”‚  â”‚  â”‚ (8 FAQs)                     â”‚â”€ COMMON_FAQS array            â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BACKEND API (Express.js)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Leprosy Routes (/api/leprosy)                                    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [POST]   /symptom-log                                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ Validate input                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ Create SymptomLog document                                  â”‚  â”‚
â”‚  â”‚  â””â”€ Save to database                                            â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [GET]    /symptom-logs                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ requireAuth middleware                                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ Query SymptomLog by userId                                  â”‚  â”‚
â”‚  â”‚  â””â”€ Return array (last 30)                                      â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [GET]    /latest-symptom-log                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ requireAuth middleware                                      â”‚  â”‚
â”‚  â”‚  â””â”€ Return most recent SymptomLog                               â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [POST]   /chat/leprosy-assistant                               â”‚  â”‚
â”‚  â”‚  â”œâ”€ Validate input (message, userId)                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ Find or create LeprosyAssistantChat                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Add user message                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ Generate AI response (keyword matching)                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ Add assistant message                                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ Keep last 100 messages                                      â”‚  â”‚
â”‚  â”‚  â””â”€ Save and return reply                                       â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [GET]    /chat-history                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ requireAuth middleware                                      â”‚  â”‚
â”‚  â”‚  â””â”€ Return all messages for user                                â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [DELETE] /chat-history                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ requireAuth middleware                                      â”‚  â”‚
â”‚  â”‚  â””â”€ Delete user's LeprosyAssistantChat                          â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  generateAssistantResponse(message: string)                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ Keyword detection (10+ categories)                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ Random response from category                               â”‚  â”‚
â”‚  â”‚  â””â”€ Fallback default response                                   â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Middleware                                                       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ - requireAuth: JWT validation                                    â”‚  â”‚
â”‚  â”‚ - CORS: Cross-origin requests                                    â”‚  â”‚
â”‚  â”‚ - Express.json: JSON parsing                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“ MongoDB Query
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATABASE (MongoDB)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Collection: SymptomLog                                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ {                                                                â”‚  â”‚
â”‚  â”‚   _id: ObjectId,                                                â”‚  â”‚
â”‚  â”‚   userId: String â¬…ï¸ INDEXED                                     â”‚  â”‚
â”‚  â”‚   symptoms: {                                                   â”‚  â”‚
â”‚  â”‚     skinPatches: Boolean,                                       â”‚  â”‚
â”‚  â”‚     numbness: Boolean,                                          â”‚  â”‚
â”‚  â”‚     weakness: Boolean,                                          â”‚  â”‚
â”‚  â”‚     eyeIssues: Boolean,                                         â”‚  â”‚
â”‚  â”‚     painfulNerves: Boolean,                                     â”‚  â”‚
â”‚  â”‚     other: String                                               â”‚  â”‚
â”‚  â”‚   },                                                            â”‚  â”‚
â”‚  â”‚   notes: String,                                                â”‚  â”‚
â”‚  â”‚   timestamp: Date,                                              â”‚  â”‚
â”‚  â”‚   createdAt: Date,                                              â”‚  â”‚
â”‚  â”‚   updatedAt: Date                                               â”‚  â”‚
â”‚  â”‚ }                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Collection: LeprosyAssistantChat                                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ {                                                                â”‚  â”‚
â”‚  â”‚   _id: ObjectId,                                                â”‚  â”‚
â”‚  â”‚   userId: String â¬…ï¸ UNIQUE & INDEXED                            â”‚  â”‚
â”‚  â”‚   messages: [                                                   â”‚  â”‚
â”‚  â”‚     {                                                           â”‚  â”‚
â”‚  â”‚       _id: ObjectId,                                            â”‚  â”‚
â”‚  â”‚       text: String,                                             â”‚  â”‚
â”‚  â”‚       sender: "user" | "assistant",                             â”‚  â”‚
â”‚  â”‚       timestamp: Date                                           â”‚  â”‚
â”‚  â”‚     }                                                           â”‚  â”‚
â”‚  â”‚   ],  â¬…ï¸ Max 100 messages kept                                   â”‚  â”‚
â”‚  â”‚   createdAt: Date,                                              â”‚  â”‚
â”‚  â”‚   updatedAt: Date                                               â”‚  â”‚
â”‚  â”‚ }                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Patient Opens Dashboard                                     â”‚
â”‚ (/patient/dashboard)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Select Leprosy Tab     â”‚
        â”‚ (clicks leprosy card)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ "ğŸ’¬ Care Assistant" Button Appears â”‚
        â”‚ (visible only on Leprosy tab)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Click Care Assistant Button        â”‚
        â”‚ router.push("/leprosy/assistant")  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Leprosy Care Assistant Opens                   â”‚
    â”‚ (/leprosy/assistant)                           â”‚
    â”‚                                                â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚ â”‚ Chat â”‚ Symptoms â”‚ Schedule â”‚  Q&A  â”‚       â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        â”‚        â”‚          â”‚         â”‚
        â–¼        â–¼        â–¼          â–¼         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚ Chat â”‚ â”‚ Symptoms â”‚ â”‚ Sched  â”‚ â”‚ Q&A  â”‚
    â”‚      â”‚ â”‚          â”‚ â”‚ ule    â”‚ â”‚      â”‚
    â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜
       â”‚          â”‚           â”‚         â”‚
       â–¼          â–¼           â–¼         â–¼
    Sends    Logs in        Views    Searches
    Msg to   Database       Weekly   FAQs
    API                    Schedule
       â”‚          â”‚           â”‚         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      Backend Processes
              â”‚
              â–¼
      Database Updated
              â”‚
              â–¼
      Response Sent
              â”‚
              â–¼
      UI Updated
```

## Data Flow Diagram

### Chat Flow
```
User Types Message
        â”‚
        â–¼
[Front] State Updated (inputMessage)
        â”‚
        â–¼
User Clicks Send
        â”‚
        â–¼
[Front] Create message object
[Front] Add to messages array
        â”‚
        â–¼
[Front] POST /api/leprosy/chat/leprosy-assistant
        â”œâ”€ message: string
        â”œâ”€ userId: string
        â””â”€ context: string
        â”‚
        â–¼
[Back] Find/Create LeprosyAssistantChat
        â”‚
        â–¼
[Back] Add user message to array
        â”‚
        â–¼
[Back] generateAssistantResponse(message)
        â”œâ”€ Detect keywords
        â”œâ”€ Match to response category
        â””â”€ Return appropriate response
        â”‚
        â–¼
[Back] Add assistant message to array
        â”‚
        â–¼
[Back] Trim to 100 messages if needed
        â”‚
        â–¼
[Back] Save to MongoDB
        â”‚
        â–¼
[Back] Return { success: true, reply: string }
        â”‚
        â–¼
[Front] Display assistant message
[Front] Auto-scroll to bottom
[Front] Clear input field
        â”‚
        â–¼
Chat Updated âœ“
```

### Symptom Logging Flow
```
User Selects Symptoms
        â”‚
        â–¼
[Front] Update symptoms state
[Front] Type in notes
        â”‚
        â–¼
User Clicks "Log Symptoms"
        â”‚
        â–¼
[Front] Validate inputs
        â”‚
        â–¼
[Front] POST /api/leprosy/symptom-log
        â”œâ”€ userId: string
        â”œâ”€ symptoms: object
        â””â”€ notes: string
        â”‚
        â–¼
[Back] Validate required fields
        â”‚
        â–¼
[Back] Create SymptomLog document
        â”‚
        â–¼
[Back] Save to MongoDB
        â”‚
        â–¼
[Back] Return { success: true, symptomLog: {...} }
        â”‚
        â–¼
[Front] Show success message
[Front] Reset form
[Front] Clear inputs
        â”‚
        â–¼
Symptom Logged âœ“
```

### Q&A Search Flow
```
User Types in Search Box
        â”‚
        â–¼
[Front] Update searchFAQ state
        â”‚
        â–¼
[Front] Filter COMMON_FAQS array
        â”œâ”€ Check question.includes(search)
        â”œâ”€ Check answer.includes(search)
        â””â”€ Return matching FAQs
        â”‚
        â–¼
[Front] Display filtered results
        â”‚
        â–¼
User Clicks Question
        â”‚
        â–¼
[Front] Update selectedFAQ state
        â”‚
        â–¼
[Front] Expand to show answer
        â”‚
        â–¼
FAQ Expanded âœ“
```

## State Management

### Component State Variables
```
âœ“ activeTab: 'chat' | 'symptoms' | 'schedule' | 'qa'
âœ“ messages: Message[] (chat)
âœ“ inputMessage: string
âœ“ isLoading: boolean
âœ“ symptoms: object (5 checkboxes + other)
âœ“ symptomNotes: string
âœ“ schedule: ScheduleItem[]
âœ“ selectedFAQ: FAQ | null
âœ“ searchFAQ: string
```

### Data Persistence
```
Database
â”œâ”€ SymptomLog (per entry)
â”œâ”€ LeprosyAssistantChat (per user)
â”‚  â””â”€ Messages array
â””â”€ [Through API]
   â””â”€ /api/leprosy/*
```

## Component Hierarchy

```
LeprosyAssistantPage
â”œâ”€ Header
â”‚  â”œâ”€ Back Button
â”‚  â”œâ”€ Title
â”‚  â””â”€ Heart Icon
â”‚
â”œâ”€ Tab Navigation
â”‚  â”œâ”€ AI Chat Tab Button
â”‚  â”œâ”€ Symptoms Tab Button
â”‚  â”œâ”€ Schedule Tab Button
â”‚  â””â”€ Q&A Tab Button
â”‚
â”œâ”€ Chat Tab (conditional)
â”‚  â”œâ”€ Messages Container
â”‚  â”‚  â”œâ”€ Assistant Messages
â”‚  â”‚  â”œâ”€ User Messages
â”‚  â”‚  â””â”€ Loading Indicator
â”‚  â””â”€ Input Area
â”‚     â”œâ”€ Text Input
â”‚     â””â”€ Send Button
â”‚
â”œâ”€ Symptoms Tab (conditional)
â”‚  â”œâ”€ Instructions
â”‚  â”œâ”€ Checkbox Group
â”‚  â”‚  â”œâ”€ Skin Patches
â”‚  â”‚  â”œâ”€ Numbness
â”‚  â”‚  â”œâ”€ Weakness
â”‚  â”‚  â”œâ”€ Eye Issues
â”‚  â”‚  â””â”€ Painful Nerves
â”‚  â”œâ”€ Notes TextArea
â”‚  â””â”€ Submit Button
â”‚
â”œâ”€ Schedule Tab (conditional)
â”‚  â”œâ”€ Title
â”‚  â”œâ”€ Schedule Items (8+)
â”‚  â”‚  â”œâ”€ Day Badge
â”‚  â”‚  â”œâ”€ Time
â”‚  â”‚  â”œâ”€ Activity Name
â”‚  â”‚  â””â”€ Description
â”‚  â””â”€ Tip Box
â”‚
â””â”€ Q&A Tab (conditional)
   â”œâ”€ Search Input
   â”œâ”€ FAQ List (filtered)
   â”‚  â”œâ”€ Question
   â”‚  â”œâ”€ Category Badge
   â”‚  â””â”€ Answer (expandable)
   â””â”€ No Results Message
```

---

**Architecture Version:** 1.0  
**Last Updated:** January 2026  
**Status:** Production Ready âœ…
